sudo: required
services:
- docker
language: python
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: RqIB6HW4SFzXmWG/sMxvUo2QMFOkscGiF8fRXQLRrvMinabdfIX38zd95e4mzZy5FbkvSsgBDexn2uepee00yIHghDkN6zSsLrq4Zffn70BjZZcOTitVeDoEWGXy1a4GL7di7ZI7n4ToxqpHhAlkv6KLX1WyiUux89GtqyVa6Oi9tqBpALOL+fzG2pZuP2k+GHeW8dycbCnPMSHSotpuEBTnSmXrflm8BQRMSQOtxe77FoB6ZXRsgCdFygB7lqAXo6juwwItHlTlWwbg2d40lO3IdkCqJeGWJpZBpgAUQIicQPJGQvhGzls9X81CP9mH5JXpIDSPtBJNSp5B0kZS6QYIhwFLBl6DwL2+XOgns87dosXcWHw94qirNEOoRElfrLE1rHI7Id/p7vcxEZxnb3B97zFnwYnKDwLXSbztWLJkK/kuhezNBCNLZPC14toYCBhW2fzD8k/P4YsIIiOd2mANpcZAXUj3ynGVEwSjVt+5zDM+1+E7uzWPEijBuAODB+1X1IK4ytTPxMsnxtB62PFHmpYsWCovIXCtzTNhcF87M5/qcMn621qo1eGMyqP2g61bQcWm1I9uDAayPIKbOPz4S3YU9OljEOlbM4Hd1LYn0nSFoK1bxqIsAGQLkVED98SESsce6QQexGRt+5EHCZJ4Q/t3oL8ORWvk4e8sjX4=
  - secure: jW4TUmDRUeLb1aZJGDfrhoNvIsaI7s1AOdC3571/pLDqqLX+GEyDo6Ckb+T4aw5ihb0bOErEGbCiLAABcMoWEl9/yDY2lnMo2psP4EPAIqcY5XJOTeFIAAvMP2Fc2U1xJeIYYNQ866ukQOqlf+cpVfImMiRFFQZHNgyV/C+0KK0RrOWYRUTF4iB6IH+JIHEwK5VU6zlCEkXTp8H99kMi5g0F5A6V7sF7b55BHYynQ2gZLuGT++Q5ogY/QpmKJRBZnKWpHONvC2nVha+D6S8HraN4bQGVClHGeAVTlfql99Z0RsrARfwRvl4vH3+D++iBLznkH6P8kuj+myowtpSTiC8TTxHZkuYMcRK244344ZH/x6JaLGj8veoii1Hx/klGmspJLNiblGPPqS0jFAdKaB54/KKUM83xjz+PyK40IhTvnp8l1/giJjXrc55T0RBoTmJjeY70CtGDDNGzvmd+xbqOgRdj2huB2195be/ka6FlfabXYsIgNCr1epb0TXt5pxWcQkUw7IXIQ0VBnMQ4s5nLSZr2LhM/esL2ts3nAl4G4SJWY20BDHv9CrWp4IaerDX7L3azDrRQgSi41WkuK+Ck+l+ZEG1nLJu0IILFf5uFU1L9KBcTLeU50oESXRXUEZW9FiD+X1F3qgdvbztuuUXxxnVCfRjGT/7kFz6GRwM=
  - secure: VkaWuw5oCrmrXs11jSGhATe5CFcPO/mJzEFxnQY2jq7mJZ95tEdemP2dJhR+f4TTkdh10wp91Qly7fuqW1CWeGU17Bf18r+iVe6iXYfVO9EwJmav030b4KO2bsp6DgYF4ESWJ9EM8LDayxzI6SDYegCfZ+vhnyMvNP0VZMbOg8MUerCQJoZ8H30mj6Qvnyf0rz9TX9pO1cfhyepc/Qj5bvl7thK5YDF5dbPJGHrXYlXYf7jtsEb1b699/tbXbmF8AaLtApjcvDjbD7K9xII7bnXuwuRBzfb0YC+rwEVJnZGim0gP6NoSXnlzNweo3ibWtquahCfbj6l4UpPak8nWW0cDkyjrYnKGULu3s7BNJ6lL4QyC9wOQ+a23dh/WtGZeOekzUgKWxxEZ+IX+PxvRqXDFPie6ukePCadtAeGf29WqBYPmjk036fmq5GNzyf+ZXXuYUw2KRpIvjZK0WUkht6+XacO9GXCT81ks/GvC3NwlYtSdE9LapVoumN44lSlKc5eyQxUS8TGCBVHO2ffXpQO2QbYtRts0Ngfana26/VOIpRcpcwvKB7i+253oZvGRYuK+GaHSTjtavFczJ96BbOEn59VAYuMgRD5YJzPLirbsgx5e/BEnEHN1Z0eEosFoAnrO0ZBjLebVBktJ8VfxLm2AzsQIIYxG2SlfH4hxk6U=
after_success:
- docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=cangr/mvsd-mongo-sync
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH
  ; fi`
- docker build -f Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
